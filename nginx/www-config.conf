server {
    listen 80;
    listen [::]:80;
    server_name finhoa.com www.finhoa.com;

    return 301 https://finhoa.com$request_uri;  # Redirect to canonical non-www HTTPS
}
server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name www.finhoa.com;

    ssl_certificate /etc/letsencrypt/live/finhoa.com/fullchain.pem;  # Use the combined cert
    ssl_certificate_key /etc/letsencrypt/live/finhoa.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    return 301 https://finhoa.com$request_uri;  # Redirect www to non-www
}
server {


     server_name  finhoa.com;
     # root   /tmp/dist;
     #index index.html;


     location / {
         add_header x-xss-protection '1; mode=block';
         add_header x-content-type-options 'nosniff';
         index  index_to_not_use.html;
	 proxy_pass http://localhost:8080;
         try_files $uri @index;
     }

      location @index {
          add_header Cache-Control 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0';
          add_header Pragma no-cache;
          add_header x-xss-protection '1; mode=block';
          add_header x-content-type-options 'nosniff';
          expires -1;
          proxy_no_cache 1;
          proxy_cache_bypass 1;
	           proxy_pass http://localhost:8080;
          try_files /index.html =200;
      }

     gzip on;
     gzip_vary on;
     gzip_min_length 10240;
     gzip_proxied expired no-cache no-store private auth;
     gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml application/javascript;
     gzip_disable "MSIE [1-6]\.";



    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/finhoa.com/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/finhoa.com/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot



}
